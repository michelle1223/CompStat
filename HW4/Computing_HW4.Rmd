---
title: "Computing HW4"
author: "Dongeun Min"
date: "11/25/2020"
output: pdf_document
---

```{r setup, message=FALSE}
library("Rcpp")
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path))
sourceCpp("Computing_HW4.cpp")
```

## Question 5.3 (a)
```{r}
x = c(6.52, 8.32, 0.31, 2.82, 9.96, 0.14, 9.64)
xbar = mean(x)
k <- 7.84654
trapezoid(xbar, -100, 100, 10000)
k * trapezoid(xbar, -100, 100, 10000)
```
When k=7.84654 is multiplied with the integration (calculated with the trapezoidal rule), the integrated value becomes 1. Therefore, 7.84654 is the right proportionality constant.

## Question 5.3 (b)
```{r}
k * riemann(xbar, 2, 8, 500)
k * trapezoid(xbar, 2, 8, 500)
k * simpson(xbar, 2, 8, 500)
```

## Question 5.3 (c)
First: ignore the singularity at 1
```{r}
lower = exp(3)/(1+exp(3))
upper = 1
k * criemann(xbar, lower, upper, 500)
k * csimpson(xbar, lower, upper, 500)
```
when using simpson's rule, there exists a singularity problem at the upper bound 1.  
  
Second: fix the singularity at 1 by fixing the upper bound as a number slightly smaller than 1
```{r}
lower = exp(3)/(1+exp(3))
upper = 1 - 0.00001
k * csimpson(xbar, lower, upper, 500)
```

## Question 5.3 (d)
```{r}
lower = 10^(-10)  #use a lower bound very slightly bigger than 0
upper = 1/3
k * dsimpson(xbar, lower, upper, 1000)
```

## Question 5.4
```{r}
a = 5  #arbitrarily choose value for a
lower = (a-1)/a
upper = a-1
t_i0 = c(1:7)
for(i in 1:7){
  t_i0[i] = gtrapezoid(lower, upper, 2^(i-1))
}
t_i1 = c(1:6)
for(i in 1:6){
  t_i1[i] = (4*t_i0[i+1] - t_i0[i]) / (4-1)
}
t_i2 = c(1:5)
for(i in 1:5){
  t_i2[i] = (4*4*t_i1[i+1] - t_i1[i]) / (4^2-1)
}
t_i3 = c(1:4)
for(i in 1:4){
  t_i3[i] = ((4^3)*t_i2[i+1] - t_i2[i]) / (4^3-1)
}
t_i4 = c(1:3)
for(i in 1:3){
  t_i4[i] = ((4^4)*t_i3[i+1] - t_i3[i]) / (4^4-1)
}
t_i5 = c(1:2)
for(i in 1:2){
  t_i5[i] = ((4^5)*t_i4[i+1] - t_i4[i]) / (4^5-1)
}
t_66 = ((4^6)*t_i5[2] - t_i5[1]) / (4^6-1)
log(a)
t_i0
t_i1
t_i2
t_i3
t_i4
t_i5
t_66
```
